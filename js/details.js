let restaurant,worker,id,reviews;var newMap;document.addEventListener("DOMContentLoaded",e=>{SWHelper.registerServiceWorker(),this.reviews=[],this.worker=new Worker("/js/restaurantWorker.js"),this.worker.onmessage=handleWorkerMessage,this.id=Helper.getParameterByName("id"),requestAnimationFrame(initReviews),getRestaurant(this.id),getReviews(this.id)}),handleWorkerMessage=(e=>{const t=e.data,n=t.msgData;switch(t.retrieved){case"restaurant":self.restaurant=n,requestAnimationFrame(initMap),requestAnimationFrame(fillRestaurantHTML);break;case"restaurantReviews":addReviews(n),requestAnimationFrame(resetReviews)}}),initMap=(()=>{const e=self.restaurant;self.newMap=L.map("map",{center:[e.latlng.lat,e.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYmluYXJ5aWRpb3QiLCJhIjoiY2pqMzZjNWRtMWF2YTNrbXRsb2VueGlydyJ9.mkjp31-552zW210Dz1PUcQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),Helper.mapMarkerForRestaurant(self.restaurant,self.newMap)}),initReviews=(()=>{const e=document.getElementById("reviews-container"),t=document.createElement("h3");t.innerHTML="Reviews",e.appendChild(t)}),getRestaurant=((e,t=self.worker)=>{t.postMessage({action:"getRestaurant",id:e})}),getReviews=((e,t=self.worker)=>{t.postMessage({action:"getRestaurantReviews",id:e})}),addReviews=(e=>{for(newReview of e){let e=!1;for([index,review]of self.reviews.entries())if(review.id==newReview.id){e=!0,self.reviews[index]=newReview;break}e||self.reviews.push(newReview)}}),fillRestaurantHTML=(()=>{const e=self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img"),n=Helper.imageUrlForRestaurant(e);t.className="restaurant-img",t.src=`${n}-small.jpg`,t.srcset=`${n}-small.jpg 300w, ${n}-medium.jpg 600w, ${n}-large.jpg 800w`,t.size="(max-width: 767) calc(100% - 30px), calc(50% - 30px)",t.alt=e.alt,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillBreadcrumb()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);const s=document.createElement("td"),i=e[n].replace(/,/,"<br>");s.innerHTML=i,a.appendChild(s),t.appendChild(a)}}),fillBreadcrumb=(()=>{const e=self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),fillReviewHTML=(()=>{const e=self.reviews,t=document.getElementById("reviews-container");if(0==e.length){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const n=document.getElementById("reviews-list");for(review of e)n.appendChild(createReviewHTML(review));t.appendChild(n)}),resetReviews=(()=>{const e=document.getElementById("no-reviews");e&&e.remove(),document.getElementById("reviews-list").innerHTML="",fillReviewHTML()}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("div");n.classList.add("review-header");const a=document.createElement("p");a.innerHTML=e.name,a.classList.add("review-name"),n.appendChild(a);const r=document.createElement("p"),s=new Date(e.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});r.innerHTML=s,r.classList.add("review-date"),n.appendChild(r);const i=document.createElement("div");i.classList.add("review-content");const d=document.createElement("p");d.innerHTML=`Rating: ${e.rating}`,d.classList.add("review-rating"),i.appendChild(d);const o=document.createElement("p");return o.innerHTML=e.comments,o.classList.add("review-comments"),i.appendChild(o),t.appendChild(n),t.appendChild(i),t});
//# sourceMappingURL=../maps/details.js.map
