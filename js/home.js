let restaurants,neighborhoods,cuisines,worker;var newMap,markers=[];document.addEventListener("DOMContentLoaded",e=>{this.worker=new Worker("js/restaurantWorker.js"),this.worker.onmessage=handleWorkerMessage,requestAnimationFrame(initMap),updateRestaurants(),getNeighborhoodsAndCuisines()}),handleWorkerMessage=(e=>{const t=e.data,s=t.msgData;switch(t.retrieved){case"restaurants":addRestaurants(s),requestAnimationFrame(fillRestaurantsHTML);break;case"neighborhoodsAndCuisines":self.neighborhoods=s.neighborhoods,requestAnimationFrame(fillNeighborhoodHTML),self.cuisines=s.cuisines,requestAnimationFrame(fillCuisineHTML)}}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYmluYXJ5aWRpb3QiLCJhIjoiY2pqMzZjNWRtMWF2YTNrbXRsb2VueGlydyJ9.mkjp31-552zW210Dz1PUcQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap)}),getRestaurants=((e,t=this.worker)=>{t.postMessage({action:"getRestaurants",filter:e})}),getNeighborhoodsAndCuisines=((e=this.worker)=>{e.postMessage({action:"getNeighborhoodsAndCuisines"})}),addRestaurants=(e=>{for(newRestaurant of e){let e=!1;for([index,restaurant]of self.restaurants.entries())if(restaurant.id==newRestaurant.id){e=!0,self.restaurants[index]=newRestaurant;break}e||self.restaurants.push(newRestaurant)}}),updateRestaurants=(()=>{resetRestaurants();const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,a=t.selectedIndex,r=e[s].value,n=t[a].value;getRestaurants({neighborhood:n,cuisine:r})}),fillNeighborhoodHTML=(()=>{const e=document.getElementById("neighborhoods-select");for(neighborhood of self.neighborhoods){const t=document.createElement("option");t.innerHTML=neighborhood,t.value=neighborhood,e.append(t)}}),fillCuisineHTML=(()=>{const e=document.getElementById("cuisines-select");for(cuisine of self.cuisines){const t=document.createElement("option");t.innerHTML=cuisine,t.value=cuisine,e.append(t)}}),fillRestaurantsHTML=(()=>{const e=document.getElementById("restaurants-list");for(restaurant of self.restaurants)e.append(createRestaurantHTML(restaurant));addMarkersToMap()}),resetRestaurants=(()=>{if(self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers)for(marker of self.markers)marker.remove();self.markers=[]}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=document.createElement("img"),a=Helper.imageUrlForRestaurant(e);s.className="restaurant-img",s.src=`${a}-small.jpg`,s.srcset=`${a}-small.jpg 300w, ${a}-medium.jpg 600w, ${a}-large.jpg 800w`,s.sizes="(max-width: 424px) 300px, (max-width: 573px) 449px, 300px",s.alt=e.alt,t.append(s);const r=document.createElement("h2");r.innerHTML=e.name,t.append(r);const n=document.createElement("p");n.innerHTML=e.neighborhood,t.append(n);const o=document.createElement("p"),i=e.address.replace(/,/,",<br>");o.innerHTML=i,t.append(o);const u=document.createElement("a");return u.innerHTML="View Details",u.href=Helper.urlForRestaurant(e),u.setAttribute("role","button"),t.append(u),t}),addMarkersToMap=(()=>{for(restaurant of self.restaurants){const e=Helper.mapMarkerForRestaurant(restaurant,self.newMap);e.on("click",()=>{window.location.href=e.options.url}),self.markers.push(e)}});
//# sourceMappingURL=../maps/home.js.map
